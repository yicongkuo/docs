<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[通用版電子地圖ArcGIS封裝檔使用方式]]></title>
    <url>%2Fhow-to%2Fposts%2FArcGIS%2Fcjzw2po9p000ea45g5382d0eq%2F</url>
    <content type="text"><![CDATA[一、 通用版電子地圖ArcGIS封裝檔簡介通用版電子地圖ArcGIS封裝檔是國土測繪中心製作公開的資料，允許使用者在電腦、行動裝置上離線瀏覽地圖。下載來的檔案解壓縮後，目錄結構會類似下圖，此為ArcGIS Cache Service的檔案結構。 由於國土測繪沒有附上Cache Service的圖磚定義檔案(Conf.xml與conf.cdi)，所以使用者需要自己建立，或是直接下載已經建立好的定義檔，才能在ArcMap或是對應的軟體中開啟地圖資料。 接下來會介紹如何自己建立圖磚定義檔案，並說明建立圖磚定義檔時，需要注意那些細節。 二、 建立圖磚定義檔需要注意的細節圖磚定義檔建立時，需要確定以下幾件事情： 圖層座標系統。 通用版電子地圖使用Web Mercator投影座標系統(EPSG:3857)。 每一層(Level)的裁切比例尺與解析度。 本文所使用的通用版電子地圖是依據Google Map的比例進行裁切。 圖片格式。本文通用版電子地圖使用jpg格式作為圖磚的圖片格式。 圖磚儲存方式。圖磚儲存方式可分為EXPLODED或是COMPACT兩種，EXPLODED直接將每張圖片儲存在資料夾內，COMPACT則是將一個的圖片壓縮成一個bundle檔案儲存。本文中的通用版電子地圖採用EXPLODED方式儲存圖片。 了解以上幾件事情後，就可以按照接下來的步驟，瀏覽電子地圖的內容囉。 三、 電子地圖使用方法：發佈為ArcGIS Server服務《1》 下載圖磚圖片檔案 到國土測繪中心網站https://maps.nlsc.gov.tw/ 點選下載專區 找到以下兩個清單項目，點選右邊下載連結即可下載 [政府開放資料]臺灣通用電子地圖(套疊等高線)圖磚封裝檔(GIS用) [政府開放資料]臺灣通用電子地圖(不含等高線)圖磚封裝檔(GIS用) 《2》 建立Web Mercator座標系統的地圖圖框 開啟ArcMap 在Table Of Contents視窗中，對Layers圖框按滑鼠右鍵，選擇Properties 定義地圖框坐標系統 A. 在Data Frame Properties視窗中，切換到Coordinate SystemB. 在搜尋列中，輸入web，然後點選右邊的搜尋按鈕C. 找到如下圖所示的座標系統定義檔，然後按確定 《3》 產生台灣全島範圍向量圖徵 (Featrue Class) 加入 Streets底圖 調整地圖範圍涵蓋台灣全島 啟用Draw工具列 使用矩形工具，在地圖上繪製台灣本島範圍 使用Convert Graphics To Features工具，將矩形圖形轉換成Feature Class 工具參數設定如下，本文中輸出的Feature Class命名為TaiwanExtent 將TaiwanExtent圖層加入圖框中 移除稍早所繪製的矩形圖形 《4》 產生地圖文件檔案mxd 移除底圖，TOC視窗中僅留下TaiwanExtent圖層 將地圖縮放至TaiwanExtent圖層範圍 將TaiwanExtent圖層邊框與填充色設為透明 儲存地圖，本文將地圖文件檔取名為NLSC_Basemap.mxd 《5》 發佈地圖快取服務 新增ArcGIS for Server連線，需要Publish以上的權限 上方工具列中，點選File &gt; Share As &gt; Service 選擇Publish Service，點選下一步 選擇稍早建立的ArcGIS Server連線，並輸入此次要發佈的服務名稱。此名稱建議使用英文，本文使用NLSC_Basemap作為此服務名稱。然後點選下一步。 選擇GIS服務要放在哪一個目錄內，本文將放在Basemap目錄內。然後點選Continue。 設定Caching選項 A. 左側視窗中，選擇 CachingB. 右側視窗中，選擇 Using tiles from a cacheC. 快取圖層定義檔設成 ArcGIS Online/Bing Maps/Google MapsD. 設定要產生的圖磚層數E. 選擇手動產生圖磚 設定Caching &gt; Advanced Settings選項 A. 由於國土測繪中心所給定的圖片為jpg格式，所以此處將圖片格式設定為jpegB. 點選Advanced按鈕，開啟進階設定 C. 由於國土測繪中心使用每一個圖磚以一張圖片的方式，儲存在資料夾中，故此處將圖磚儲存方式設定為EXPLODED。 D. 完成Caching設定後，在Service Editor中點選Analyze按鈕，檢查服務設定上是否有錯誤或需要改進的地方。 E. 如果沒有出現Error，則在Service Editor中，點選Publish按鈕發佈服務 F. 發佈過程中，出現要將TaiwanExtent這筆資料複製到主機上，點選OK繼續發佈過程 G. 出現服務發佈成功對話視窗，點選OK完成服務發佈。 《6》 複製圖磚檔案到ArcGIS Server主機上 連線到ArcGIS Server主機 預設情況下，在C:\\arcgisserver\\directories\\arcgiscache中，會找到剛才發佈的快取服務存放圖磚的資料夾位置。 點開此服務資料夾至Layers資料夾內，會看到如下圖的資料夾結構。 將從國土測繪中心網站下載的圖磚檔案，複製到_alllayers資料夾內即可。 從瀏覽器上瀏覽服務，即可看到通用版地圖。 四、 使用方法：透過ArcMap瀏覽電子地圖《1》 建立ArcGIS Raster Dataset資料夾結構 下載圖磚定義檔conf.cdi與Conf.xml 建立一個名稱為Layers的資料夾 將conf.cdi與Conf.xml複製到Layers目錄內 在Layers目錄中，建立一個名為 _alllayers 的資料夾 把下載來的通用版電子地圖L0 ~ L15的資料夾移動到_alllayers資料夾內 目前Layers資料夾目錄內容應該如下圖所示 《2》 開啟ArcMap瀏覽地圖 開啟ArcMap 在Catalog視窗中，連線存放Layers資料夾的根目錄，此時會看到Layers為一個Raster Dataset格式 將Layers拖曳至Table of Content視窗中，ArcMap會呈現地圖內容。不過目前地圖框縮放比例與圖磚裁切比例不符，因此圖層在顯示上會產生模糊的情況。 調整第圖框的縮放比例，讓圖層可以使用正確比例顯示。 A. 點選比例尺下拉選單，選擇Customize The List… B. 點選Delete All刪除現有顯示比例 C. 點選Load ArcGIS Online/Bing Maps/Google Maps載入ArcGIS Online底圖圖磚比例 D. 將Only display these scales when zooming打勾，並按確定 E. 現在通用版電子地圖會清楚地呈現囉！]]></content>
      <categories>
        <category>ArcGIS</category>
      </categories>
      <tags>
        <tag>通用版電子地圖</tag>
        <tag>ArcGIS封裝檔</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ArcMap 台灣常見座標轉換流程]]></title>
    <url>%2Fhow-to%2Fposts%2FArcGIS%2FArcMap%2Fcjzw2po4w0000a45gz9rfzrmf%2F</url>
    <content type="text"><![CDATA[在ArcToolbox中有個 「Create Custom Geographic Transformation」 工具，可以提供使用者自訂座標系統轉換參數。台灣的使用者可以透過該工具自訂TWD67、TWD97、WGS84三種常見座標系統的轉換參數，設定好的轉換參數檔案(*.gtf)預設放在以下目錄，使用者可以自行複製到其他電腦使用。 C:\Users\&lt;user&gt;\AppData\Roaming\ESRI\Desktop&lt;版本&gt;\ArcToolbox \CustomTransformations 設定完畢之後，定義為TWD67、TWD97、WGS84座標系統的地理資料，就可以使用 「Project」 工具，套用設定好的轉換參數進行座標系統轉換。因此使用ArcMap進行座標轉換流程可分為以下兩大步驟： 1.使用 「Create Custom Geographic Transformation」 建立轉換公式 2.使用 「Project」 對地理資料進行座標系統轉換 以下將針對上述兩步驟進行詳述。 建立轉換公式建立TWD67 – TWD97 座標轉換參數 在ArcToolbox中開啟 「Create Custom Geographic Transformation」 工具，工具位於Data Management Tools &gt; Projections and Transformations底下 依照以下資料輸入對應的參數值，並點選 「OK」 即可建立完成 參數名稱 參數值 Geographic Transformation Name TWD67 – TWD97 Input Geographic Coordinate System TWD_1967_TM_Taiwan Output Geographic Coordinate System TWD_1997_TM_Taiwan Method Coordinate Frame 【轉換參數】 X Axis Translation (meters) X軸平移量(公尺) 730.160 Y Axis Translation (meters) Y軸平移量(公尺) 346.212 Z Axis Translation (meters) Z軸平移量(公尺) 472.186 X Axis Rotation (seconds) X軸旋轉量(秒) 7.968009465325332199694565793688 Y Axis Rotation (seconds) Y軸旋轉量(秒) 3.5498173155125282722429064796627 Z Axis Rotation (seconds) Z軸旋轉量(秒) 0.40634166830677981965825251394163 Scale Difference (ppm) 尺度參數 0.99998180 轉換方法與參數說明本文所提及的轉換方法是根據Help中的說明，Coordinate Frame法與台灣地區常用的Bursa-Wolf法在程式引擎當中是一樣的，所以在設定時選擇Coordinate Frame法。 轉換參數則是使用史天元老師等人於測量工程第41卷第3期所發表的 「TWD67與TWD97大地基準轉換方法研究」 一文中所提及的七參數Bursa-Wolf基準轉換參數，並將旋轉量單位徑換算為秒（因為Create Custom Geographic Transformation工具需要輸入秒）後所得的數值。在 「TWD67與TWD97大地基準轉換方法研究」 一文中，有提到經計算所得的七參數會有誤差，因此轉換結果也會有誤差。 建立TWD97 – WGS84 座標轉換參數 在ArcToolbox中開啟 「Create Custom Geographic Transformation」 工具，工具位於Data Management Tools &gt; Projections and Transformations底下 依照以下資料輸入對應的參數值，並點選 「OK」 即可建立完成 參數名稱 參數值 Geographic Transformation Name TWD97 – WGS84 Input Geographic Coordinate System TWD_1997_TM_Taiwan Output Geographic Coordinate System GCS_WGS_1984 Method GEOCENTRIC_TRANSLATION 【轉換參數】 Name Value X Axis Translation (meters) 0 Y Axis Translation (meters) 0 Z Axis Translation (meters) 0 轉換方法與參數說明由EPSG 7.1版資料庫中查詢得知TWD97與WGS84的轉換方式名稱為 「TWD97 to WGS84」 ，編號是 「3830」 ，使用地區為 「台灣，中華民國，近陸與近海，台灣島、澎湖（澎湖群島）島」 ，轉換精度為 「1」 公尺。 註記當中說明了 「近似值有正負一公尺的水準，假設TWD97近似於WGS84的話」 。資料來源為 「OGP（International Association of Oil &amp; Gas producers，國際油氣製造業協會）。 座標轉換方法名稱 「地理中心轉移」 。轉換參數有三個， 「X軸轉移為0」 、 「Y軸轉移為0」 、 「Z軸轉移為0」 ，且該轉換是可進行逆向轉換的。 由以上描述內容可得，TWD97經緯度基本上等同於WGS84經緯度，因為X軸、Y軸、Z軸的平移皆為0 座標轉換 在ArcToolbox中開啟 「Project」 工具，工具位於 Data Management Tools \ Projections and Transformations 底下 只要 「Input Coordinate System」 與 「Output Coordinate System」 互為TWD67、TWD97、WGS84，就可以在 「Geographic Transformation」 的下拉選單中，選擇建立好的轉換公式。 按下 「OK」 完成座標轉換 在ArcMap中加入不同座標系統的地理資料使用ArcMap時如果加入不同座標系統的地理資料，ArcMap一般會跳出警告訊息，如下圖。 如果此時按下 「Transformation」 按鈕，也可以指定要使用的轉換參數 TWD97與TWD67轉換結果比較當比例尺要放到很大，會發現TWD97與TWD67地理資料會有誤差。利用 「Measure」 工具量測，視地區不同，誤差約一公尺左右。]]></content>
      <categories>
        <category>ArcGIS</category>
        <category>ArcMap</category>
      </categories>
      <tags>
        <tag>座標轉換</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[使用免安裝版的PostgresSQL建立空間資料庫]]></title>
    <url>%2Fhow-to%2Fposts%2FPostgreSQL%2Fcjzw2po5g0002a45gi4l7gp4l%2F</url>
    <content type="text"><![CDATA[本文將介紹如何使用PostgreSQL，在本機電腦上建置一個可以隨時帶著走的地理資料庫，方便程式開發階段或是教學階段時使用。 《1》 檢查ArcGIS支援哪一個版本的PostgreSQL 先到ArcGIS Help頁面選擇你要使用的ArcGIS版本 查詢有支援的最小版本 《2》 下載PostgresSQL 連到PostgreSQL官方網站 點選zip archive 選擇適合的版本下載 《3》 讓PostgreSQL具有儲存空間資料的能力 在ArcMap預設安裝目錄下，找到DatabaseSupport資料夾，預設安裝路徑為C:\Program Files (x86)\ArcGIS\Desktop版本號碼\DatabaseSupport 找到PostgreSQL資料夾，然後依據你下載的版本，進入該版本的資料夾，然後再進入Windows64資料夾 複製資料夾中的st_geometry.dll以及libst_raster_pg.dll，到 PostgresSQL資料夾/lib 中 《4》 初始化你的PostgreSQL將以下程式碼複製到文字檔中，然後副檔案改成.bat儲存。然後執行這個批次檔。 12345678910111213141516@ECHO ONREM The script sets environment variables helpful for PostgreSQL@SET PATH="%~dp0\bin";%PATH%@SET PGDATA=%~dp0\data@SET PGDATABASE=postgres@SET PGUSER=postgres@SET PGPORT=5432@SET PGLOCALEDIR=%~dp0\share\localeREM remark after first runrem "%~dp0\bin\initdb" -U postgres -A trust"%~dp0\bin\pg_ctl" -D "%~dp0/data" -l logfile startECHO "Click enter to stop"pause"%~dp0\bin\pg_ctl" -D "%~dp0/data" stop]]></content>
      <categories>
        <category>PostgreSQL</category>
      </categories>
      <tags>
        <tag>地理資料庫</tag>
      </tags>
  </entry>
</search>
